这份 **`01_Layout_Spec.md`** 已经根据我们之前打磨的所有共识（包括 4K 适配、左树右表、吸顶逻辑、平板支持等）进行了终极整合。你可以直接将其保存到项目的 `/specs` 目录中。

---

# 01_Layout_Spec.md (v1.2 - Final)

> **版本**: v1.2
> **状态**: Approved (Final)
> **最后更新**: 2026-01-17
> **核心原则**: 保证造价数字化平台在高密度数据展示下的交互稳定性与视觉一致性。

---

## 一、 全局框架解剖 (Anatomy)

### 1.1 三区布局结构

平台采用固定的 **Header-Sidebar-Main** 模式，严禁任何页面偏离此基础结构。

```
┌─────────────────────────────────────────────────────────────────┐
│              Header (56px Fixed, z-index: 1000)                 │
│  [Logo] [采集] [资产] [质控] [计价] [估算]            [通知] [用户] │
├────────────┬────────────────────────────────────────────────────┤
│  Sidebar   │  Main Content (Scrollable Container)               │
│ (240px/64px│ ┌──────────────────────────────────────────────┐   │
│  Fixed)    │ │ Breadcrumb & Page Header (Sticky)            │   │
│            │ ├──────────────────────────────────────────────┤   │
│            │ │ Filter Bar / Attribute Tags (Sticky)         │   │
│            │ ├──────────────────────────────────────────────┤   │
│            │ │                                              │   │
│            │ │ Data Area (Table/Charts/Form)                │   │
│            │ │                                              │   │
│            │ └──────────────────────────────────────────────┘   │
└────────────┴────────────────────────────────────────────────────┘

```

### 1.2 关键尺寸与约束

* **Header**: 高度 `56px`。必须置顶固定。
* **Sidebar**: 展开 `240px`，收起 `64px`。折叠仅限按钮触发，不支持手势拖拽。
* **Main**: 背景色 `#F0F2F5`。标准内边距 `24px`。
* **滚动策略**: 严禁窗口级滚动（Double Scrollbar）。滚动条应仅出现在 Main 内部的数据展示区。

---

## 二、 响应式与适配规则 (Responsive)

### 2.1 断点策略 (Breakpoints)

| 范围 | 设备类型 | Sidebar 策略 | 布局表现 |
| --- | --- | --- | --- |
| **< 1024px** | 手机/小平板 | 不支持 | 暂不适配，显示“请使用专业设备” |
| **1024px - 1365px** | iPad Pro / 平板 | 强制收起 | 最小化布局，表格启用横滚 |
| **1366px - 1599px** | 普通笔记本 | 默认收起 | 优先保证内容区宽度 |
| **1600px - 2559px** | 标准/高清屏 | 默认展开 | 最佳展示效果 |
| **≥ 2560px** | 4K/超宽屏 | 默认展开 | **居中留白**：内容区最大宽 `2400px` |

### 2.2 视觉深度

* **深色模式**: 暂不支持，统一使用 Light Mode。
* **字号**: 默认 `14px`。高密度列表可缩减至 `12px`。

---

## 三、 典型页面模式 (Page Patterns)

### 3.1 模式 A：左树右表 (造价核心)

适用于项目管理、指标库、材价库。

* **左侧树面板**: 默认 `280px`。必须支持鼠标拖拽调整宽度（min: 200px, max: 500px）。
* **右侧顶部**:
1. **面包屑与操作行**: 标题在左，功能按钮（导入/导出）在右。
2. **属性选择区 (Tags)**: 采用 Checkable Tag 样式，超过两行自动折叠。
3. **条件过滤行 (Filters)**: 搜索框、单价区间、时间选择。


* **吸顶逻辑**: 以上三层在纵向滚动时必须全部 **Sticky** 固定。

### 3.2 模式 B：三栏式工作台

适用于质控详情、智能套定额、测算。

* **结构**: 左目录 (20%) + 中清单 (50%) + 右属性 (30%)。
* **面板联动**: 点击中间清单行，右侧面板即时更新对应清单的详细属性。

---

## 四、 交互细节规范 (Interaction)

### 4.1 滚动与固定 (Sticky)

* **TableHeader**: 滚动至顶部时必须自动吸顶。
* **Footer**: 分页组件及汇总信息栏固定在底部，不随表格内容滚动。

### 4.2 容器自适应

* **MUST**: 使用 Flex 或 Grid 布局，禁止在代码中使用硬编码的 `height: 800px`。
* **MUST**: 计算高度公式：`contentHeight = 100vh - Header - PageHeader - FilterHeight`。

---

## 五、 给 Windsurf 的执行指令 (Instruction)

1. **读取规范**: 在生成任何新页面布局前，必须以此文件为基准。
2. **避免 Bug**:
* 检查是否存在双滚动条。
* 检查侧边栏折叠时内容区是否平滑重新计算宽度。
* 检查 4K 分辨率下的居中容器是否生效。


3. **标准化**: 左右分割面板必须引入 `Resizable` 逻辑，允许用户调整宽度。

---

## 六、 变更记录 (Changelog)

* **v1.0**: 初始草案。
* **v1.1**: 确认 4K 留白与平板适配细节。
* **v1.2**: 增加吸顶逻辑、树面板可拖拽宽度、以及三栏工作台定义。

---

