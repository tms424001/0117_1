# 质控模块总览规格说明书

> 版本：V1.0  
> 更新日期：2026-01-18  
> 文档状态：初稿  
> 所属模块：09_Quality_Control

---

## 1. 模块概述

### 1.1 模块定位

质控模块是造价成果的**智能审核与对比分析中枢**，通过规则引擎实现事中监控，将传统"人工审核、事后纠偏"升级为"规则驱动、实时检查"。

```
┌─────────────────────────────────────────────────────────────────────────┐
│                           质控模块价值主张                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   传统模式                              本平台                          │
│   ────────                              ──────                          │
│   • 人工逐项审核                        • 规则引擎自动检查               │
│   • 事后发现问题                        • 事中实时监控                   │
│   • 经验依赖个人                        • 规则沉淀为资产                 │
│   • 审核标准不一                        • 统一检查基准                   │
│   • 漏检率高                            • 全覆盖无遗漏                   │
│                                                                         │
│   核心能力：标准化引擎（归一化后才能比）+ 规则引擎（可配置检查逻辑）    │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 1.2 模块架构

```
┌─────────────────────────────────────────────────────────────────────────┐
│                              质控模块                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────┐    ┌─────────────────────────────┐    │
│  │      单文件检查              │    │      多文件对比              │    │
│  │    （纵向深度审查）          │    │    （横向对比分析）          │    │
│  ├─────────────────────────────┤    ├─────────────────────────────┤    │
│  │  ├─ 合规性检查              │    │  ├─ 清标                    │    │
│  │  │   编码/单位/特征/结构    │    │  │   投标文件对比            │    │
│  │  │                          │    │  │                          │    │
│  │  ├─ 材料价格检查            │    │  ├─ 结算复核                │    │
│  │  │   合理性/一致性/逻辑性   │    │  │   结算 vs 合同价          │    │
│  │  │                          │    │  │                          │    │
│  │  ├─ 综合单价检查            │    │  ├─ 概算归集                │    │
│  │  │   区间/占比/完整性       │    │  │   各阶段 vs 概算          │    │
│  │  │                          │    │  │                          │    │
│  │  ├─ 清单缺陷检查            │    │  └─ 对标分析                │    │
│  │  │   缺失/矛盾/漏项/异常    │    │      项目 vs 类似项目均值   │    │
│  │  │                          │    │                              │    │
│  │  └─ 指标合理性检查          │    │                              │    │
│  │      单方造价/含量/占比     │    │                              │    │
│  └─────────────────────────────┘    └─────────────────────────────┘    │
│                                                                         │
│                              ▼                                          │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                        检查规则库                                 │  │
│  │    规则配置 + 阈值管理 + 版本控制 + 启用/禁用                     │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                              ▼                                          │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                        Issue 管理                                 │  │
│  │    发现 → 确认 → 修改 → 复核 → 闭合                               │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 1.3 与平台其他模块的关系

```
┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│                    ┌─────────────────┐                                  │
│                    │    数据采集      │                                  │
│                    │   (造价文件)     │                                  │
│                    └────────┬────────┘                                  │
│                             │ 快速采集                                   │
│                             ▼                                           │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                 │
│  │   计价模块   │───▶│   质控模块   │◀───│   估算模块   │                 │
│  │  (成果产出)  │    │  (审核检查)  │    │  (参照对标)  │                 │
│  └─────────────┘    └──────┬──────┘    └─────────────┘                 │
│                            │                                            │
│                            │ 依赖                                       │
│                            ▼                                            │
│                   ┌─────────────────┐                                   │
│                   │   标准化引擎     │                                   │
│                   │  (归一化基础)    │                                   │
│                   └────────┬────────┘                                   │
│                            │                                            │
│            ┌───────────────┼───────────────┐                           │
│            ▼               ▼               ▼                           │
│     ┌───────────┐   ┌───────────┐   ┌───────────┐                     │
│     │  材价库    │   │  综价库    │   │  指标库    │                     │
│     │ (价格基准) │   │ (单价参照) │   │ (指标参照) │                     │
│     └───────────┘   └───────────┘   └───────────┘                     │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

**关键依赖说明：**

| 依赖项 | 作用 | 必要性 |
|--------|------|--------|
| 标准化引擎 | 材料/清单归一化后才能进行有效比对 | **必须** |
| 材价库 | 提供材料价格基准和合理区间 | 材料价格检查必须 |
| 综价库 | 提供综合单价历史数据参照 | 综合单价检查必须 |
| 指标库 | 提供经济指标、含量指标参照 | 指标检查必须 |
| 案例库 | 提供同类项目样本用于对标分析 | 对标分析必须 |

### 1.4 快速采集模式

质控模块支持"**采集即用**"模式：用户在质控过程中上传的文件，完成检查后自动沉淀到数据采集模块。

```
用户上传文件 → 质控检查 → 问题修复 → 检查通过
                                        │
                                        ▼ 自动沉淀
                              数据采集（造价文件）
                                来源标记：质控
```

---

## 2. 功能清单

### 2.1 单文件检查

| 功能编号 | 功能名称 | 功能描述 | 规格文档 |
|----------|----------|----------|----------|
| QC-S-01 | 合规性检查 | 检查清单编码、计量单位、项目特征、费用结构的规范性 | 01_Compliance_Check_Spec.md |
| QC-S-02 | 材料价格检查 | 检查材料价格的合理性、一致性、逻辑性 | 02_Material_Price_Check_Spec.md |
| QC-S-03 | 综合单价检查 | 检查综合单价的合理性、一致性、组成完整性 | 03_Composite_Price_Check_Spec.md |
| QC-S-04 | 清单缺陷检查 | 检查特征缺失、特征矛盾、清单漏项、工程量异常 | 04_BoQ_Defect_Check_Spec.md |
| QC-S-05 | 指标合理性检查 | 检查单方造价、含量指标、分部占比的合理性 | 05_Index_Rationality_Check_Spec.md |

### 2.2 多文件对比

| 功能编号 | 功能名称 | 功能描述 | 规格文档 |
|----------|----------|----------|----------|
| QC-M-01 | 清标 | 投标文件与控制价的对比分析，识别不平衡报价 | 06_Bid_Clearing_Spec.md |
| QC-M-02 | 结算复核 | 结算文件与合同价的对比分析，核查变更与调差 | 07_Settlement_Review_Spec.md |
| QC-M-03 | 概算归集 | 各阶段造价与批复概算的对比，投资控制追踪 | 08_Budget_Collection_Spec.md |
| QC-M-04 | 对标分析 | 当前项目与同类项目的指标对比分析 | 09_Benchmark_Analysis_Spec.md |

### 2.3 通用功能

| 功能编号 | 功能名称 | 功能描述 |
|----------|----------|----------|
| QC-C-01 | 检查规则管理 | 规则配置、阈值设置、启用/禁用、版本管理 |
| QC-C-02 | Issue 管理 | 问题的全生命周期管理 |
| QC-C-03 | 质控报告 | 检查结果的结构化输出 |
| QC-C-04 | 快速采集 | 检查完成后自动沉淀到数据采集 |

---

## 3. 检查规则库

### 3.1 规则分类体系

```
检查规则库
├── 合规性规则（Compliance）
│   ├── 编码规则（清单编码格式、有效性）
│   ├── 单位规则（计量单位匹配）
│   ├── 特征规则（必填特征、格式规范）
│   └── 结构规则（费用组成完整性）
│
├── 价格规则（Price）
│   ├── 材料价格规则（合理性、一致性、逻辑性）
│   └── 综合单价规则（区间、占比、完整性）
│
├── 清单规则（BoQ）
│   ├── 缺陷规则（缺失、矛盾）
│   ├── 漏项规则（关联项检查）
│   └── 工程量规则（异常值检测）
│
├── 指标规则（Index）
│   ├── 经济指标规则（单方造价区间）
│   ├── 含量指标规则（含钢量、含混凝土量）
│   └── 占比规则（分部占比、人材机占比）
│
└── 对比规则（Compare）
    ├── 偏离率规则（总价、分部、清单项）
    ├── 变更规则（新增、删除、调整）
    └── 对标规则（指标对比阈值）
```

### 3.2 规则数据结构

```typescript
interface QCRule {
  // 基本信息
  ruleId: string;              // 规则ID，如 "CMP-001"
  ruleName: string;            // 规则名称
  ruleCategory: RuleCategory;  // 规则分类
  ruleType: RuleType;          // 规则类型
  
  // 规则定义
  description: string;         // 规则描述
  checkLogic: string;          // 检查逻辑表达式或脚本
  parameters: RuleParameter[]; // 可配置参数
  
  // 严重程度
  severity: 'error' | 'warning' | 'info';  // 严重/一般/提示
  
  // 状态管理
  isEnabled: boolean;          // 是否启用
  version: string;             // 规则版本
  
  // 适用范围
  applicableFileTypes: FileType[];  // 适用文件类型
  applicableStages: Stage[];        // 适用计价阶段
  
  // 元数据
  createdAt: Date;
  updatedAt: Date;
  createdBy: string;
}

interface RuleParameter {
  paramName: string;           // 参数名
  paramType: 'number' | 'percentage' | 'enum' | 'boolean';
  defaultValue: any;           // 默认值
  currentValue: any;           // 当前值
  description: string;         // 参数说明
}

type RuleCategory = 'compliance' | 'price' | 'boq' | 'index' | 'compare';
type RuleType = 'single' | 'multi';  // 单文件/多文件
type FileType = 'estimate' | 'budget' | 'bidControl' | 'bid' | 'contract' | 'settlement';
type Stage = 'estimate' | 'budget' | 'bidding' | 'contract' | 'settlement';
```

### 3.3 规则示例

**示例1：材料价格逻辑性检查**

```json
{
  "ruleId": "PRC-MAT-003",
  "ruleName": "混凝土强度等级价格逻辑",
  "ruleCategory": "price",
  "ruleType": "single",
  "description": "高强度等级混凝土单价应不低于低强度等级",
  "checkLogic": "IF material.type == 'concrete' AND materialA.grade > materialB.grade THEN materialA.price >= materialB.price",
  "parameters": [],
  "severity": "error",
  "isEnabled": true,
  "version": "1.0.0",
  "applicableFileTypes": ["estimate", "budget", "bidControl", "bid", "settlement"],
  "applicableStages": ["estimate", "budget", "bidding", "contract", "settlement"]
}
```

**示例2：材料费占比异常检查**

```json
{
  "ruleId": "PRC-CMP-002",
  "ruleName": "综合单价材料费占比检查",
  "ruleCategory": "price",
  "ruleType": "single",
  "description": "综合单价中材料费占比超过阈值时告警",
  "checkLogic": "IF compositePrice.materialRatio > threshold THEN warning",
  "parameters": [
    {
      "paramName": "threshold",
      "paramType": "percentage",
      "defaultValue": 95,
      "currentValue": 95,
      "description": "材料费占比告警阈值（%）"
    }
  ],
  "severity": "warning",
  "isEnabled": true,
  "version": "1.0.0",
  "applicableFileTypes": ["bidControl", "bid", "settlement"],
  "applicableStages": ["bidding", "contract", "settlement"]
}
```

**示例3：投标总价偏离率检查**

```json
{
  "ruleId": "CMP-BID-001",
  "ruleName": "投标总价偏离率检查",
  "ruleCategory": "compare",
  "ruleType": "multi",
  "description": "投标总价与控制价偏离超过阈值时标记",
  "checkLogic": "ABS((bidPrice - controlPrice) / controlPrice) > threshold",
  "parameters": [
    {
      "paramName": "warningThreshold",
      "paramType": "percentage",
      "defaultValue": 5,
      "currentValue": 5,
      "description": "偏离率警告阈值（%）"
    },
    {
      "paramName": "errorThreshold",
      "paramType": "percentage",
      "defaultValue": 10,
      "currentValue": 10,
      "description": "偏离率错误阈值（%）"
    }
  ],
  "severity": "warning",
  "isEnabled": true,
  "version": "1.0.0",
  "applicableFileTypes": ["bid"],
  "applicableStages": ["bidding"]
}
```

### 3.4 规则管理功能

| 功能 | 描述 |
|------|------|
| 规则列表 | 按分类/类型/状态筛选，支持搜索 |
| 规则详情 | 查看规则定义、参数配置、适用范围 |
| 参数配置 | 调整规则阈值和参数，不影响规则逻辑 |
| 启用/禁用 | 按需开关单条规则 |
| 版本管理 | 规则变更记录，支持回滚 |
| 规则导入/导出 | 支持规则集的备份和迁移 |

---

## 4. Issue 生命周期

### 4.1 Issue 状态机

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          Issue 状态流转                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│                              ┌─────────┐                                │
│                              │  发现   │                                │
│                              │ (Open)  │                                │
│                              └────┬────┘                                │
│                                   │                                     │
│                      ┌────────────┼────────────┐                       │
│                      ▼            │            ▼                       │
│               ┌───────────┐      │      ┌───────────┐                 │
│               │   确认    │      │      │   忽略    │                 │
│               │(Confirmed)│      │      │ (Ignored) │                 │
│               └─────┬─────┘      │      └───────────┘                 │
│                     │            │                                     │
│                     ▼            │ 标记误报                            │
│               ┌───────────┐      │                                     │
│               │   修改中   │◀────┘                                     │
│               │(Fixing)   │                                            │
│               └─────┬─────┘                                            │
│                     │                                                   │
│                     ▼                                                   │
│               ┌───────────┐                                            │
│               │   待复核   │                                            │
│               │(ToReview) │                                            │
│               └─────┬─────┘                                            │
│                     │                                                   │
│          ┌──────────┼──────────┐                                       │
│          ▼                     ▼                                       │
│   ┌───────────┐         ┌───────────┐                                 │
│   │   已闭合   │         │ 重新打开  │                                 │
│   │ (Closed)  │         │(Reopened) │─────▶ 返回修改中                │
│   └───────────┘         └───────────┘                                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 4.2 Issue 数据结构

```typescript
interface Issue {
  // 基本信息
  issueId: string;             // Issue ID
  projectId: string;           // 所属项目
  fileId: string;              // 所属文件
  
  // 问题定位
  locationType: 'global' | 'division' | 'item' | 'material';
  locationPath: string;        // 定位路径，如 "分部分项/土建/混凝土/第35行"
  lineNumber?: number;         // 行号
  
  // 问题内容
  ruleId: string;              // 触发的规则ID
  ruleName: string;            // 规则名称
  severity: 'error' | 'warning' | 'info';
  title: string;               // 问题标题
  description: string;         // 问题描述
  suggestion: string;          // 修改建议
  
  // 问题数据
  actualValue: any;            // 实际值
  expectedValue?: any;         // 期望值
  deviation?: number;          // 偏差值/偏差率
  
  // 状态管理
  status: IssueStatus;
  
  // 处理信息
  assignee?: string;           // 处理人
  fixDescription?: string;     // 修复说明
  reviewComment?: string;      // 复核意见
  
  // 元数据
  createdAt: Date;
  updatedAt: Date;
  closedAt?: Date;
}

type IssueStatus = 'open' | 'confirmed' | 'fixing' | 'toReview' | 'closed' | 'ignored' | 'reopened';
```

### 4.3 Issue 处理流程

| 步骤 | 操作者 | 动作 | 状态变化 |
|------|--------|------|----------|
| 1. 发现 | 系统 | 规则引擎检测到问题 | → Open |
| 2. 确认 | 审核人 | 确认问题有效 | Open → Confirmed |
| 2'. 忽略 | 审核人 | 标记为误报或可接受 | Open → Ignored |
| 3. 分配 | 审核人 | 指定处理人 | Confirmed → Fixing |
| 4. 修复 | 处理人 | 完成修复，提交复核 | Fixing → ToReview |
| 5. 复核 | 审核人 | 验证修复结果 | ToReview → Closed |
| 5'. 驳回 | 审核人 | 修复不符合要求 | ToReview → Reopened → Fixing |

---

## 5. 质控报告

### 5.1 报告结构

```
┌─ 质控报告 ───────────────────────────────────────────────────────────────┐
│                                                                          │
│  报告基本信息                                                            │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │ 项目名称：某住宅项目招标控制价                                      │ │
│  │ 文件类型：招标控制价                                                │ │
│  │ 检查时间：2026-01-18 14:30:25                                      │ │
│  │ 检查人员：张三                                                      │ │
│  │ 规则版本：v2.1.0                                                    │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
│  检查概况                                                                │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │                                                                    │ │
│  │   检查规则     命中问题     问题分布                                │ │
│  │   ┌─────┐     ┌─────┐     ┌─────────────────────┐                 │ │
│  │   │ 128 │     │  23 │     │ 🔴 严重    3 (13%)  │                 │ │
│  │   │  条 │     │  条 │     │ 🟡 一般   12 (52%)  │                 │ │
│  │   └─────┘     └─────┘     │ 🔵 提示    8 (35%)  │                 │ │
│  │                           └─────────────────────┘                 │ │
│  │                                                                    │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
│  问题清单                                                                │
│  ┌────────┬────────────────────────────────┬──────────┬──────────────┐ │
│  │ 级别   │ 问题描述                        │ 定位     │ 修改建议     │ │
│  ├────────┼────────────────────────────────┼──────────┼──────────────┤ │
│  │ 🔴严重 │ 螺纹钢价格3200元/t，            │ 材料表   │ 核实价格，   │ │
│  │        │ 低于信息价4580元/t的30%        │ 第35行   │ 参考信息价   │ │
│  ├────────┼────────────────────────────────┼──────────┼──────────────┤ │
│  │ 🔴严重 │ C40混凝土单价380元/m³          │ 材料表   │ 调整价格，   │ │
│  │        │ 低于C30混凝土420元/m³          │ 第58行   │ 高标号应更高 │ │
│  ├────────┼────────────────────────────────┼──────────┼──────────────┤ │
│  │ 🟡一般 │ 矩形柱项目特征缺少截面尺寸      │ 清单表   │ 补充截面尺寸 │ │
│  │        │                                │ 第12行   │ 如"400×400"  │ │
│  ├────────┼────────────────────────────────┼──────────┼──────────────┤ │
│  │ 🔵提示 │ 含钢量65kg/㎡，                 │ 全局     │ 关注结构设计 │ │
│  │        │ 高于同类项目均值52kg/㎡约25%   │          │ 是否合理     │ │
│  └────────┴────────────────────────────────┴──────────┴──────────────┘ │
│                                                                          │
│  检查维度统计                                                            │
│  ┌────────────────────────────────────────────────────────────────────┐ │
│  │ 检查类型           规则数    命中数    通过率                       │ │
│  │ ───────────────────────────────────────────────────                │ │
│  │ 合规性检查           25         2       92%                        │ │
│  │ 材料价格检查         32         8       75%                        │ │
│  │ 综合单价检查         28         5       82%                        │ │
│  │ 清单缺陷检查         23         4       83%                        │ │
│  │ 指标合理性检查       20         4       80%                        │ │
│  └────────────────────────────────────────────────────────────────────┘ │
│                                                                          │
└──────────────────────────────────────────────────────────────────────────┘
```

### 5.2 报告数据结构

```typescript
interface QCReport {
  // 报告基本信息
  reportId: string;
  projectId: string;
  projectName: string;
  fileId: string;
  fileName: string;
  fileType: FileType;
  
  // 检查信息
  checkTime: Date;
  checkUser: string;
  ruleVersion: string;
  
  // 检查统计
  statistics: {
    totalRules: number;        // 检查规则总数
    totalIssues: number;       // 发现问题总数
    errorCount: number;        // 严重问题数
    warningCount: number;      // 一般问题数
    infoCount: number;         // 提示问题数
    passRate: number;          // 整体通过率
  };
  
  // 分类统计
  categoryStats: {
    category: RuleCategory;
    ruleCount: number;
    issueCount: number;
    passRate: number;
  }[];
  
  // 问题列表
  issues: Issue[];
  
  // 报告状态
  status: 'draft' | 'final';
  exportFormats: ('pdf' | 'excel' | 'word')[];
}
```

### 5.3 报告输出格式

| 格式 | 适用场景 |
|------|----------|
| 在线预览 | 即时查看，支持交互操作（跳转定位、Issue处理） |
| PDF | 正式报告归档，不可编辑 |
| Excel | 问题清单导出，便于跟踪处理 |
| Word | 正式报告，支持编辑批注 |

---

## 6. 业务场景与流程

### 6.1 单文件检查流程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         单文件检查流程                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐             │
│  │ 上传文件 │───▶│ 文件解析 │───▶│ 标准化  │───▶│ 规则检查 │             │
│  └─────────┘    └─────────┘    └─────────┘    └─────────┘             │
│                                     │              │                    │
│                    材料→SMLCode     │              │                    │
│                    清单→SBoQCode    │              │                    │
│                                     │              ▼                    │
│                                     │        ┌─────────┐               │
│                                     │        │ 生成报告 │               │
│                                     │        └────┬────┘               │
│                                     │             │                    │
│                                     │    ┌────────┼────────┐          │
│                                     │    ▼        ▼        ▼          │
│                                     │  有问题   无问题   查看报告      │
│                                     │    │        │        │          │
│                                     │    ▼        │        │          │
│                                     │ Issue处理   │        │          │
│                                     │    │        │        │          │
│                                     │    ▼        ▼        │          │
│                                     │  修复后    ┌──────┐  │          │
│                                     │  重新检查  │ 通过  │  │          │
│                                     │    │       └──┬───┘  │          │
│                                     │    │          │      │          │
│                                     │    └──────────┼──────┘          │
│                                     │               ▼                  │
│                                     │        ┌───────────┐            │
│                                     └───────▶│ 快速采集   │            │
│                                              │ 沉淀数据   │            │
│                                              └───────────┘            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 6.2 多文件对比流程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         多文件对比流程                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────┐           │
│  │                    选择对比模式                          │           │
│  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │           │
│  │  │  清标   │ │结算复核 │ │概算归集 │ │对标分析 │       │           │
│  │  └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘       │           │
│  └───────┼───────────┼───────────┼───────────┼─────────────┘           │
│          │           │           │           │                          │
│          ▼           ▼           ▼           ▼                          │
│  ┌─────────────────────────────────────────────────────────┐           │
│  │                   设置基准文件                           │           │
│  │   清标：控制价    结算：合同价    概算：批复概算          │           │
│  │   对标：当前项目                                         │           │
│  └─────────────────────────┬───────────────────────────────┘           │
│                            │                                            │
│                            ▼                                            │
│  ┌─────────────────────────────────────────────────────────┐           │
│  │                   选择对比文件                           │           │
│  │   清标：多份投标文件                                     │           │
│  │   结算：结算文件                                         │           │
│  │   概算：招标/合同/结算                                   │           │
│  │   对标：同类项目（自动筛选或手动选择）                   │           │
│  └─────────────────────────┬───────────────────────────────┘           │
│                            │                                            │
│                            ▼                                            │
│  ┌─────────────────────────────────────────────────────────┐           │
│  │                   文件标准化                             │           │
│  │   所有文件统一归一化到 SMLCode / SBoQCode               │           │
│  └─────────────────────────┬───────────────────────────────┘           │
│                            │                                            │
│                            ▼                                            │
│  ┌─────────────────────────────────────────────────────────┐           │
│  │                   执行对比分析                           │           │
│  │   • 总价对比                                             │           │
│  │   • 分部对比                                             │           │
│  │   • 清单项对比                                           │           │
│  │   • 材料价对比                                           │           │
│  │   • 指标对比（对标分析）                                 │           │
│  └─────────────────────────┬───────────────────────────────┘           │
│                            │                                            │
│                            ▼                                            │
│  ┌─────────────────────────────────────────────────────────┐           │
│  │                   生成对比报告                           │           │
│  │   • 对比结果汇总                                         │           │
│  │   • 偏差项明细                                           │           │
│  │   • 分析结论与建议                                       │           │
│  └─────────────────────────────────────────────────────────┘           │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 6.3 Issue 处理流程

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          Issue 处理流程                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  审核人视角                           处理人视角                        │
│  ──────────                           ──────────                        │
│                                                                         │
│  ┌─────────────┐                                                        │
│  │ 查看Issue列表│                                                        │
│  │ 筛选严重级别 │                                                        │
│  └──────┬──────┘                                                        │
│         │                                                               │
│         ▼                                                               │
│  ┌─────────────┐                                                        │
│  │ 确认/忽略   │                                                        │
│  │ 问题有效性  │                                                        │
│  └──────┬──────┘                                                        │
│         │                                                               │
│         │ 确认有效                                                       │
│         ▼                                                               │
│  ┌─────────────┐                     ┌─────────────┐                   │
│  │ 分配处理人  │────────────────────▶│ 接收Issue   │                   │
│  └──────┬──────┘                     └──────┬──────┘                   │
│         │                                   │                           │
│         │                                   ▼                           │
│         │                            ┌─────────────┐                   │
│         │                            │ 定位问题    │                   │
│         │                            │ 查看详情    │                   │
│         │                            └──────┬──────┘                   │
│         │                                   │                           │
│         │                                   ▼                           │
│         │                            ┌─────────────┐                   │
│         │                            │ 修改文件    │                   │
│         │                            │ 按建议调整  │                   │
│         │                            └──────┬──────┘                   │
│         │                                   │                           │
│         │                                   ▼                           │
│  ┌─────────────┐                     ┌─────────────┐                   │
│  │ 复核修改    │◀────────────────────│ 提交复核    │                   │
│  └──────┬──────┘                     └─────────────┘                   │
│         │                                                               │
│    ┌────┴────┐                                                         │
│    ▼         ▼                                                         │
│ 通过      驳回                                                          │
│    │         │                                                         │
│    ▼         └──────────────────────▶ 返回修改                         │
│ ┌─────────────┐                                                        │
│ │ 关闭Issue   │                                                        │
│ └─────────────┘                                                        │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 7. 页面清单

### 7.1 页面列表

| 页面编号 | 页面名称 | 页面路径 | 功能说明 |
|----------|----------|----------|----------|
| QC-P-01 | 质控工作台 | `/qc/dashboard` | 质控模块首页，任务概览、待处理Issue |
| QC-P-02 | 项目列表 | `/qc/projects` | 质控项目管理，新建/导入项目 |
| QC-P-03 | 单文件检查 | `/qc/check/single/:fileId` | 单文件质控检查主界面 |
| QC-P-04 | 检查结果 | `/qc/check/result/:checkId` | 检查结果查看、Issue列表 |
| QC-P-05 | 清标对比 | `/qc/compare/bid-clearing` | 投标文件对比分析 |
| QC-P-06 | 结算复核 | `/qc/compare/settlement` | 结算与合同价对比 |
| QC-P-07 | 概算归集 | `/qc/compare/budget` | 各阶段造价与概算对比 |
| QC-P-08 | 对标分析 | `/qc/compare/benchmark` | 项目与同类项目对标 |
| QC-P-09 | Issue列表 | `/qc/issues` | Issue全局管理 |
| QC-P-10 | Issue详情 | `/qc/issues/:issueId` | Issue详情与处理 |
| QC-P-11 | 规则管理 | `/qc/rules` | 检查规则配置管理 |
| QC-P-12 | 报告查看 | `/qc/reports/:reportId` | 质控报告在线查看 |

### 7.2 页面关系

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          质控模块页面关系                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│                        ┌─────────────────┐                              │
│                        │   质控工作台     │                              │
│                        │  QC-P-01        │                              │
│                        └────────┬────────┘                              │
│                                 │                                       │
│              ┌──────────────────┼──────────────────┐                   │
│              ▼                  ▼                  ▼                   │
│     ┌─────────────┐    ┌─────────────┐    ┌─────────────┐             │
│     │  项目列表    │    │  Issue列表  │    │  规则管理   │             │
│     │  QC-P-02    │    │  QC-P-09    │    │  QC-P-11    │             │
│     └──────┬──────┘    └──────┬──────┘    └─────────────┘             │
│            │                  │                                        │
│            ▼                  ▼                                        │
│     ┌─────────────┐    ┌─────────────┐                                │
│     │ 单文件检查  │    │ Issue详情   │                                │
│     │  QC-P-03    │    │  QC-P-10    │                                │
│     └──────┬──────┘    └─────────────┘                                │
│            │                                                           │
│            ▼                                                           │
│     ┌─────────────┐                                                   │
│     │  检查结果   │                                                   │
│     │  QC-P-04    │─────────────────────┐                             │
│     └──────┬──────┘                     │                             │
│            │                            ▼                             │
│            │                     ┌─────────────┐                      │
│            │                     │  报告查看   │                      │
│            │                     │  QC-P-12    │                      │
│            │                     └─────────────┘                      │
│            │                                                           │
│            │                                                           │
│  ──────────┴────────── 多文件对比入口 ─────────────────────────        │
│            │                                                           │
│     ┌──────┴──────┬──────────────┬──────────────┐                     │
│     ▼             ▼              ▼              ▼                     │
│ ┌─────────┐ ┌─────────┐   ┌─────────┐   ┌─────────┐                  │
│ │ 清标对比 │ │结算复核 │   │概算归集 │   │对标分析 │                  │
│ │ QC-P-05 │ │ QC-P-06 │   │ QC-P-07 │   │ QC-P-08 │                  │
│ └─────────┘ └─────────┘   └─────────┘   └─────────┘                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 8. API 接口概览

### 8.1 接口分组

| 分组 | 前缀 | 说明 |
|------|------|------|
| 项目管理 | `/api/qc/projects` | 质控项目的CRUD |
| 单文件检查 | `/api/qc/check/single` | 单文件检查相关 |
| 多文件对比 | `/api/qc/check/compare` | 多文件对比相关 |
| Issue管理 | `/api/qc/issues` | Issue的CRUD与状态流转 |
| 规则管理 | `/api/qc/rules` | 规则配置管理 |
| 报告管理 | `/api/qc/reports` | 报告生成与导出 |

### 8.2 核心接口

| 接口 | 方法 | 路径 | 说明 |
|------|------|------|------|
| 创建检查任务 | POST | `/api/qc/check/single` | 上传文件，创建单文件检查任务 |
| 执行检查 | POST | `/api/qc/check/single/{taskId}/execute` | 执行规则检查 |
| 获取检查结果 | GET | `/api/qc/check/single/{taskId}/result` | 获取检查结果和Issue列表 |
| 创建对比任务 | POST | `/api/qc/check/compare` | 创建多文件对比任务 |
| 设置对比文件 | PUT | `/api/qc/check/compare/{taskId}/files` | 设置基准文件和对比文件 |
| 执行对比 | POST | `/api/qc/check/compare/{taskId}/execute` | 执行对比分析 |
| 获取Issue列表 | GET | `/api/qc/issues` | 按条件查询Issue |
| 更新Issue状态 | PUT | `/api/qc/issues/{issueId}/status` | Issue状态流转 |
| 获取规则列表 | GET | `/api/qc/rules` | 获取规则配置 |
| 更新规则参数 | PUT | `/api/qc/rules/{ruleId}/params` | 调整规则阈值 |
| 导出报告 | POST | `/api/qc/reports/{reportId}/export` | 导出PDF/Excel/Word |

---

## 9. 数据权限

### 9.1 权限矩阵

| 角色 | 创建检查 | 执行检查 | 查看结果 | 处理Issue | 关闭Issue | 规则配置 |
|------|:--------:|:--------:|:--------:|:---------:|:---------:|:--------:|
| 超级管理员 | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ |
| 质控管理员 | ✓ | ✓ | ✓ | ✓ | ✓ | ✓ |
| 质控审核员 | ✓ | ✓ | ✓ | ✓ | ✓ | - |
| 造价工程师 | ✓ | ✓ | ✓ | ✓ | - | - |
| 项目经理 | - | - | ✓ | - | - | - |
| 数据录入员 | ✓ | ✓ | ✓ | - | - | - |

### 9.2 数据范围

| 权限级别 | 数据范围 | 说明 |
|----------|----------|------|
| 全部数据 | 企业所有项目 | 质控管理员 |
| 部门数据 | 本部门项目 | 部门负责人 |
| 本人数据 | 本人创建/参与的项目 | 普通用户 |

---

## 10. 子文档索引

| 序号 | 文档名称 | 文档路径 | 状态 |
|------|----------|----------|:----:|
| 01 | 合规性检查规格 | 01_Compliance_Check_Spec.md | 📋 |
| 02 | 材料价格检查规格 | 02_Material_Price_Check_Spec.md | 📋 |
| 03 | 综合单价检查规格 | 03_Composite_Price_Check_Spec.md | 📋 |
| 04 | 清单缺陷检查规格 | 04_BoQ_Defect_Check_Spec.md | 📋 |
| 05 | 指标合理性检查规格 | 05_Index_Rationality_Check_Spec.md | 📋 |
| 06 | 清标规格 | 06_Bid_Clearing_Spec.md | 📋 |
| 07 | 结算复核规格 | 07_Settlement_Review_Spec.md | 📋 |
| 08 | 概算归集规格 | 08_Budget_Collection_Spec.md | 📋 |
| 09 | 对标分析规格 | 09_Benchmark_Analysis_Spec.md | 📋 |

---

## 11. 版本历史

| 版本 | 日期 | 修订内容 | 作者 |
|------|------|----------|------|
| V1.0 | 2026-01-18 | 初稿，完成模块总览框架 | - |

---

## 附录 A：术语表

| 术语 | 英文 | 说明 |
|------|------|------|
| 质控 | Quality Control (QC) | 造价成果的质量检查与控制 |
| 单文件检查 | Single File Check | 对单个造价文件进行纵向深度审查 |
| 多文件对比 | Multi-File Compare | 对多个造价文件进行横向对比分析 |
| 清标 | Bid Clearing | 招标阶段对投标文件的对比分析 |
| 结算复核 | Settlement Review | 对结算文件与合同价的对比审核 |
| 概算归集 | Budget Collection | 各阶段造价与批复概算的对比追踪 |
| 对标分析 | Benchmark Analysis | 项目与同类项目的指标对比分析 |
| Issue | Issue | 质控检查发现的问题项 |
| 规则引擎 | Rule Engine | 执行检查规则的核心组件 |
| 偏离率 | Deviation Rate | 实际值与基准值的偏差百分比 |

---

## 附录 B：相关文档

| 文档名称 | 路径 | 关系 |
|----------|------|------|
| 标准化引擎规格 | 02_Standard_Library/ | 质控依赖标准化 |
| 材价库规格 | 08_Data_Asset/Enterprise_Material_Price_Spec.md | 价格检查数据源 |
| 综价库规格 | 08_Data_Asset/Enterprise_Composite_Price_Spec.md | 单价检查数据源 |
| 指标库规格 | 08_Data_Asset/Enterprise_Index_Spec.md | 指标检查数据源 |
| 案例库规格 | 08_Data_Asset/Enterprise_Case_Spec.md | 对标分析数据源 |